(()=>{var e={};e.id=702,e.ids=[702],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},61212:e=>{"use strict";e.exports=require("async_hooks")},78893:e=>{"use strict";e.exports=require("buffer")},3199:e=>{"use strict";e.exports=require("console")},84770:e=>{"use strict";e.exports=require("crypto")},27920:e=>{"use strict";e.exports=require("diagnostics_channel")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},96119:e=>{"use strict";e.exports=require("perf_hooks")},35816:e=>{"use strict";e.exports=require("process")},86624:e=>{"use strict";e.exports=require("querystring")},76162:e=>{"use strict";e.exports=require("stream")},66083:e=>{"use strict";e.exports=require("stream/web")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},61814:e=>{"use strict";e.exports=require("util/types")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},15673:e=>{"use strict";e.exports=require("node:events")},84492:e=>{"use strict";e.exports=require("node:stream")},47261:e=>{"use strict";e.exports=require("node:util")},10288:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>l}),r(38256),r(22834),r(90120),r(35866);var s=r(23191),a=r(88716),i=r(37922),n=r.n(i),o=r(95231),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let l=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,38256)),"C:\\Users\\Rafae\\Desktop\\crm-system\\src\\app\\dashboard\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,22834)),"C:\\Users\\Rafae\\Desktop\\crm-system\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,90120)),"C:\\Users\\Rafae\\Desktop\\crm-system\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\Rafae\\Desktop\\crm-system\\src\\app\\dashboard\\page.tsx"],c="/dashboard/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},80288:(e,t,r)=>{Promise.resolve().then(r.bind(r,7022))},64157:(e,t,r)=>{Promise.resolve().then(r.bind(r,60808))},7022:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(10326),a=r(59033);function i({children:e}){return(0,s.jsxs)("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-800",children:[s.jsx(a.Y,{}),s.jsx("div",{className:"flex-1 overflow-auto",children:s.jsx("main",{className:"p-6",children:e})})]})}},60808:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(10326),a=r(17577),i=r(94001),n=r(98187),o=r(24821),d=r(47602),l=r(71006),u=r(85658),c=r(36321),m=r(86527),p=r(77120);function x(e,t){let r=+(0,p.Q)(e)-+(0,p.Q)(t);return r<0?-1:r>0?1:r}var h=r(88802),g=r(34332),f=r(67886),D=r(78306);function y(){let{user:e}=(0,i.a)(),[t,r]=(0,a.useState)([]),[y,v]=(0,a.useState)([]),[w,N]=(0,a.useState)([]),[q,A]=(0,a.useState)(!0),M=t.length,T=y.filter(e=>"OPEN"===e.status||"PENDING"===e.status).length,_=y.filter(e=>{if("WON"!==e.status&&"LOST"!==e.status)return!1;let t=new Date,r=t.getMonth(),s=t.getFullYear();if(!e.updatedAt)return!1;let a=e.updatedAt instanceof o.EK?e.updatedAt.toDate():new Date(e.updatedAt);return a.getMonth()===r&&a.getFullYear()===s}).length,E=(0,a.useMemo)(()=>[...w].filter(e=>!e.completed).sort((e,t)=>{if(!e.dueDate)return 1;if(!t.dueDate)return -1;let r=e.dueDate instanceof o.EK?e.dueDate.toDate():new Date(e.dueDate),s=t.dueDate instanceof o.EK?t.dueDate.toDate():new Date(t.dueDate);return r.getTime()-s.getTime()}).slice(0,4),[w]),S=e=>{var t,r;return e?(r={addSuffix:!0},function(e,t,r){var s,a,i,n;let o;let d=(0,u.j)(),y=r?.locale??d.locale??l._,b=x(e,t);if(isNaN(b))throw RangeError("Invalid time value");let k=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:b}),[j,v]=(0,m.d)(r?.in,...b>0?[t,e]:[e,t]),w=(s=v,a=j,(n=void 0,e=>{let t=(n?Math[n]:Math.trunc)(e);return 0===t?0:t})((+(0,p.Q)(s)-+(0,p.Q)(a))/1e3)),N=Math.round((w-((0,c.D)(v)-(0,c.D)(j))/1e3)/60);if(N<2){if(r?.includeSeconds){if(w<5)return y.formatDistance("lessThanXSeconds",5,k);if(w<10)return y.formatDistance("lessThanXSeconds",10,k);if(w<20)return y.formatDistance("lessThanXSeconds",20,k);if(w<40)return y.formatDistance("halfAMinute",0,k);else if(w<60)return y.formatDistance("lessThanXMinutes",1,k);else return y.formatDistance("xMinutes",1,k)}return 0===N?y.formatDistance("lessThanXMinutes",1,k):y.formatDistance("xMinutes",N,k)}if(N<45)return y.formatDistance("xMinutes",N,k);if(N<90)return y.formatDistance("aboutXHours",1,k);if(N<h.H_)return y.formatDistance("aboutXHours",Math.round(N/60),k);if(N<2520)return y.formatDistance("xDays",1,k);if(N<h.fH){let e=Math.round(N/h.H_);return y.formatDistance("xDays",e,k)}if(N<2*h.fH)return o=Math.round(N/h.fH),y.formatDistance("aboutXMonths",o,k);if((o=function(e,t,r){let[s,a,i]=(0,m.d)(void 0,e,e,t),n=x(a,i),o=Math.abs((0,g.T)(a,i));if(o<1)return 0;1===a.getMonth()&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-n*o);let d=x(a,i)===-n;(function(e,t){let r=(0,p.Q)(e,void 0);return+(0,f.i)(r,void 0)==+(0,D.V)(r,void 0)})(s)&&1===o&&1===x(s,i)&&(d=!1);let l=n*(o-+d);return 0===l?0:l}(v,j))<12){let e=Math.round(N/h.fH);return y.formatDistance("xMonths",e,k)}{let e=o%12,t=Math.trunc(o/12);return e<3?y.formatDistance("aboutXYears",t,k):e<9?y.formatDistance("overXYears",t,k):y.formatDistance("almostXYears",t+1,k)}}(t=e instanceof o.EK?e.toDate():e instanceof Date?e:new Date(e),(0,d.L)(t,Date.now()),r)):"N/A"},P=(()=>{let e=[];for(let r of[...t].sort((e,t)=>{let r=e.createdAt instanceof o.EK?e.createdAt.toDate().getTime():0;return(t.createdAt instanceof o.EK?t.createdAt.toDate().getTime():0)-r}).slice(0,2))e.push({title:"New Customer Added",description:`${r.name} was added as a new customer`,time:S(r.createdAt),timestamp:r.createdAt instanceof o.EK?r.createdAt.toDate().getTime():0});for(let t of[...y].filter(e=>"WON"===e.status||"LOST"===e.status).sort((e,t)=>{let r=e.updatedAt instanceof o.EK?e.updatedAt.toDate().getTime():0;return(t.updatedAt instanceof o.EK?t.updatedAt.toDate().getTime():0)-r}).slice(0,2))e.push({title:`Deal ${"WON"===t.status?"Won":"Lost"}`,description:`${t.title} (${t.customerName||"Unknown customer"}) was marked as ${t.status.toLowerCase()}`,time:S(t.updatedAt),timestamp:t.updatedAt instanceof o.EK?t.updatedAt.toDate().getTime():0});for(let t of[...w].filter(e=>e.completed).sort((e,t)=>{let r=e.updatedAt instanceof o.EK?e.updatedAt.toDate().getTime():0;return(t.updatedAt instanceof o.EK?t.updatedAt.toDate().getTime():0)-r}).slice(0,2))e.push({title:"Task Completed",description:t.title,time:S(t.updatedAt),timestamp:t.updatedAt instanceof o.EK?t.updatedAt.toDate().getTime():0});return e.sort((e,t)=>t.timestamp-e.timestamp).slice(0,4)})(),C=e=>{if(!e)return"No due date";let t=e instanceof o.EK?e.toDate():new Date(e),r=new Date;if(t.getDate()===r.getDate()&&t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear())return"Today";let s=new Date(r);return(s.setDate(s.getDate()+1),t.getDate()===s.getDate()&&t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear())?"Tomorrow":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})},K=async e=>{try{let t=w.find(t=>t.id===e);if(!t)return;await (0,n.gU)(n.Ul.TASKS,e,{completed:!t.completed}),N(w.map(t=>t.id===e?{...t,completed:!t.completed}:t))}catch(e){console.error("Error updating task completion:",e)}};return q?s.jsx("div",{className:"text-center p-8 dark:text-white",children:"Загрузка данных..."}):(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold mb-6 dark:text-white",children:"Dashboard"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx(b,{title:"Всего клиентов",value:M.toString(),change:t.length>0?"+1":"0",trend:"up"}),s.jsx(b,{title:"Активные сделки",value:T.toString(),change:T>0?"+1":"0",trend:"up"}),s.jsx(b,{title:"Закрытые сделки (Месяц)",value:_.toString(),change:_>0?"+1":"0",trend:"up"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:"Последние действия"}),s.jsx("div",{className:"space-y-4",children:0===P.length?s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"Не найдено последних действий"}):P.map((e,t)=>s.jsx(k,{title:e.title,description:e.description,time:e.time},t))})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:"Следующие задачи"}),s.jsx("div",{className:"space-y-3",children:0===E.length?s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"Не найдено следующих задач"}):E.map(e=>s.jsx(j,{title:e.title,dueDate:C(e.dueDate),priority:e.priority||"medium",id:e.id||"",completed:e.completed,onTaskComplete:K},e.id))})]})]})]})}function b({title:e,value:t,change:r,trend:a}){return(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow p-6",children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e}),s.jsx("p",{className:"text-3xl font-bold mt-1 dark:text-white",children:t}),s.jsx("div",{className:"flex items-center mt-2",children:(0,s.jsxs)("span",{className:`text-sm ${"up"===a?"text-green-500":"text-red-500"}`,children:[r,"up"===a?s.jsx("svg",{className:"w-3 h-3 ml-1 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}):s.jsx("svg",{className:"w-3 h-3 ml-1 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]})})]})}function k({title:e,description:t,time:r}){return(0,s.jsxs)("div",{className:"border-l-4 border-primary-500 pl-4 py-1",children:[s.jsx("p",{className:"font-medium dark:text-white",children:e}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:t}),s.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:r})]})}function j({title:e,dueDate:t,priority:r,id:a,completed:i,onTaskComplete:n}){return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-600 dark:border-2 rounded-md dark:bg-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",className:"mr-3 h-4 w-4 text-primary-600 rounded",checked:i,onChange:()=>n(a)}),s.jsx("span",{className:`dark:text-white ${i?"line-through text-gray-500 dark:text-gray-400":""}`,children:e})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-2",children:t}),s.jsx("span",{className:`text-xs px-2 py-1 rounded ${(()=>{switch(r){case"high":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}})()}`,children:r})]})]})}},22834:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`C:\Users\Rafae\Desktop\crm-system\src\app\dashboard\layout.tsx#default`)},38256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`C:\Users\Rafae\Desktop\crm-system\src\app\dashboard\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[92,21,496,907,241],()=>r(10288));module.exports=s})();